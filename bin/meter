#!/usr/bin/env ruby
require 'celluloid'
require 'celluloid/autostart'
require_relative '../lib/udp_listener'
require_relative '../lib/pipeline'

STDOUT.sync = true

puts "Starting UDP listener"

pipeline = Pipeline.pool

listener = UdpListener.new do |data|
  pipeline.async.process(data)
end

sleep
